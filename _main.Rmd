---
title: "Bookdown Template"
author: "Rethink Priorities"
bibliography: ["assets/bib/book.bib"]
always_allow_html: yes
link-citations: yes
github-repo: rethinkpriorities/bookdown-template
description: "The Rethink Priorities bookdown template"
site: bookdown::bookdown_site
---


# About {.unnumbered}

This book is a bookdown template to be used for various projects of the Rethink Priorities survey team. The main goal of this book is to serve as a skeleton project that can be copied and used in other projects. Additionally, it contains some chapters that serve as tutorials for different features of this bookdown format.

You can find other content that will be helpful across bookdowns in the `main,R`, `index.Rmd` files in our other bookdowns, and `support`, `code`, and `assets` folders within these. 


#### Contributions {.unnumbered}

Please add yourself to the list below to acknowledge your contributions.

-   Willem Sleegers: [willem\@rethinkpriorities.org](mailto:willem@rethinkpriorities.org)

-   David Reinstein: [dreinstein\@rethinkpriorities.org](mailto:dreinstein@rethinkpriorities.org)

<!--chapter:end:index.Rmd-->

# How to use this template

The goal of this template is to make it easy to get started on writing a `bookdown` book. The word 'book' might be a misnomer because you can also use it to write notes, a manual (similar to this bookdown), a thesis, and many other things.

If you have enough time, the best way to get started is to read the `bookdown` [book](https://bookdown.org/yihui/bookdown/). For those in a hurry, we list the important steps below.

## Setup

1.  Clone this template from GitHub. The easiest way to do this is to open RStudio and select File -> New Project -> Version Control -> Git. The repository URL of this template is "<https://github.com/rethinkpriorities/bookdown-template>". After entering this, and changing some of the other settings if you want to, click on Create Project.

2.  Next, go to the Build tab (next to Environment, History, and Connection) and click on "Build Book".

3.  Done. The book is up and running!

## Usage

The template is in and of itself not interesting, so now you need to adapt the content. The first thing to adapt are the contents of 'index.Rmd'. You should change some of the information at the top of the file (between the two `---` symbols). These are the YAML options and you can change them to alter the meta-information of the book or to change some of the settings.

After changing the content of this file, you should start adding chapters. This template comes with a 'chapters' folder where you can store individual chapter files. You can simply take one of the example chapters and change the content. You should also change the file names, but in order for the book to include the chapter when you build it, you should change the contents of `_bookdown.yml`. Make sure to adapt the file paths in the `rmd_files` option so it refers to the new chapter. The order of these file paths also determines the order of the chapters in the book.

<!--chapter:end:chapters/how-to.Rmd-->

# Code

An important reason for creating this bookdown template is to present analyses performed in R. Not only do we want to show these results, we also want to show the R code that was used to produce those results. This can be done by using so-called code chunks.

## Code chunks

A code chunk is created by using using two sets of three back ticks (\`\`\`). In the case of R code, you add a set of parentheses containing the letter `r`, followed by a label that describes the code chunk. The actual R code goes between the sets of back ticks. For example, in the code chunk below we use R code to present a summary of the `cars` data frame.

````markdown
`r ''````{r cars}
summary(cars)
```
````

This produces the following result:

```{r cars}

# adding a comment here to make this code chunk a bit more visible
# for this example

summary(cars)

```


By default, the code that produces this result is hidden. Readers who are interested in the code can click on the 'Toggle code' button in the navigation bar to show all the code chunks.

Note that the toggle code button is a custom feature and is not supported out of the box when you begin a `bookdown` project.

Note that the above example table is output in a 'raw text' format; this could be styled to be more attractive with packages such as `kableExtra`.


<!--chapter:end:chapters/code.Rmd-->

# Foldable Sections

Our bookdown template supports foldable sections by means of custom blocks and custom code. Note that this means this feature is not supported out of the box and that some setup is necessary if you start with a fresh install of the `bookdown` format. It is recommended to clone the files of this template so that you don't have to worry about it.

A foldable section can be created by placing text between two sets of three colons (`:::`) and specifying the `.foldable` class between two curly braces. In addition, you should add a line of HTML code to add a button that folds and unfolds the section. An example is shown below.

    ::: {.foldable}
    <button class="fold-button">Show me more</button>

    This is a foldable section.
    :::

This creates the following foldable section:

::: foldable
<button class="fold-button">  Show me more  </button>

This is a foldable section.
:::

You can specify which text the button shows initially, but once you click on the button it will show "Show me less". This text could be changed to something else in the `header.html` file that can be found in the `html` folder of the `assets` folder.

The reason you have to specify the button itself is because of performance reasons. By putting the HTML code into the section itself, the text will be immediately shown to the user when a page is loaded. If we add the button using JavaScript, the label will initially not be shown and only show up after some (variable) time when the page is first opened.

\

We have had some issues with multiple foldables in the past, so I include another one just for testing, and to show a 'multi-line' foldable with a different opening text.

::: foldable
<button class="fold-button">  Do not open this foldable unless you want to hear about a lion  </button>

**ROAR**

samantha Dec 2013

The Lion & the Lamb And so the lion fell in love with the lamb She thought she had the upper hand But fate got in the way And the lion had nothing to say So they began a life together Determined to last forever For their love was stronger than you would believe So intense it almost decieves But the lion couldn't overcome All the obstacles to be with the one He left the lamb with tears in her eyes And wouldn't return despite her tries Now the lamb couldn't comprehend Why the lion wouldn't spend A life time with her by his side the lion and his stupid pride But the lion soon came to regret The fact that he could ever let His precious lamb get away And now the lion knew what to say He needed his lamb and needed her bad See he missed the love that they had But the lamb did not forgive All that the lion did But she loved her lion, she couldn't deny Even if she couldn't explain why And so the lion fell in love with the lamb Stupid lion, stupid lamb

From: <https://hellopoetry.com/words/lion/>

(we warned you)
:::

That's foldables for ya.

## Different types of content and different times of bla bla who cares I just need words

Can they contain:

Inline r code?:

::: {.foldable}
<button class="fold-button">  Show me more  </button>

let's try some `r 2+2`
:::


Footnotes like this one?^[I'm a footnote]

::: {.foldable}
<button class="fold-button">  Show me more  </button>

Here comes a footnote.^[I'm a footnote fwa;ef awf awefj aw;lefj wa;lekfj aw;lefj aw;lefkj aw;lefj aw;lkfj awf awf aw;lkefj aw;lefj aw;lefj ;awjef ;alwkjef afawef awefwfawefawfwafwafawefawfeawfwafwafewafwafawfwafawfawfwfwaefw]
:::


itemized lists?:

::: {.foldable}
<button class="fold-button">  Show me more  </button>

Here comes a list

- item one
- item two
   - second level
   
:::


Html commented out text?:

::: {.foldable}
<button class="fold-button">  Show me more  </button>
<!-- html comment thing -->
more text
:::

Latex math bits like "$x^2$?"?:

::: {.foldable}
<button class="fold-button">  Show me more  </button>
trying ... $x^2$?
:::

<!--chapter:end:chapters/foldable-sections.Rmd-->

# Callout blocks

You can create a callout block by creating a custom block and giving it one of the following classes: `.rmdnote`, `.rmdimportant`, `.rmdcaution`, `.rmdwarning`, `.rmdtip`.

For example:

    ::: {.rmdnote}
    This is a callout block.
    :::

They look like this:

::: {.rmdnote}
This is a callout block.
:::

::: {.rmdimportant}
This one is for something positive, I guess?
:::

::: {.rmdcaution}
This is to indicate something bad!
:::

::: {.rmdwarning}
This is to cast a warning.
:::

::: {.rmdtip}
This one is for if you like this kind of blue, I suppose.
:::

<!--chapter:end:chapters/callout.Rmd-->

# Footnotes

Footnotes are supported using the typical Markdown format:

`This sentence has a footnote.^[Here I am!]`

The result: This sentence has a footnote.^[Here I am!]

The footnotes are shown in-line using [bigfoot.js](http://www.bigfootjs.com). Simply click on the footnote to show a popover window that contains the footnote. 

<!--chapter:end:chapters/footnotes.Rmd-->

# Tables

```{r, message=FALSE}
library(tidyverse)
library(knitr)
```

| Tables   |      Are      |   Cool | Filler  | Filler 2     | Even more | Another column          | Another one   |
|----------|:-------------:|-------:|---------|--------------|-----------|-------------------------|---------------|
| col 1 is | left-aligned  | \$1600 | Content | More content | OPhOh     | Maybe now its cuts off? | Or now maybe? |
| col 2 is |   centered    |   \$12 |         |              |           |                         |               |
| col 3 is | right-aligned |    \$1 |         |              |           |                         |               |

```{r}
d1 <- head(iris)
kable(select(starwars, -films))
```

<!--chapter:end:chapters/tables.Rmd-->

# EA Forum

We often need to make output into a format acceptable for the EA Forum.

Our current thinking for the EA Survey reports is:

-   Bookdown: detailed graphs and analysis, some technical details, but minimal discussion. Link to our 'methodology' bookdown where relevant, rather than re-explaining a concept

-   EA Forum: Summaries and excerpts of the analysis and figures, more discussion, interpretation, and implications.

Typically, RP has made EA Forum these posts first in Google Docs for feedback and then there is some sort of procedure to get it into EA forum markdown syntax from there. For some previous posts, we pasted from the Rstudio visual mode pastes into Google docs for narrative, and figures/tables could be manually pasted. But we want to avoid having to do that!

David Reinstein has worked with Pete and others on tools to (mostly) automate this conversion and hosting process, but some manual tweaks were needed at the end. See the work on this [here, at bottom](https://github.com/rethinkpriorities/ea-data/blob/master/main_2020.R), and in [this R script](https://github.com/rethinkpriorities/ea-data/blob/master/code/parse_ea_forum_md.R) and [this Python script](https://github.com/rethinkpriorities/ea-data/blob/master/code/fix_eafo_links.py). Yes, it's spaghetti code.

Atm, some formatting adjustments are necessary, but both EA forum and our bookdown style templates are changing.

<!--chapter:end:chapters/EA-forum.Rmd-->

